# Alert Message Contract

## Overview
The `/alerts` topic provides notifications when system metrics exceed configured thresholds or when system events occur.

## Message Definition
```
# Alert.msg
string alert_id
float64 timestamp
string severity
string component
string metric_name
float64 current_value
float64 threshold_value
string message
string node_name
string alert_type
builtin_interfaces/Time header
```

## Fields

| Field | Type | Description | Validation |
|-------|------|-------------|------------|
| alert_id | string | Unique identifier for the alert | Required, UUID format recommended |
| timestamp | float64 | Unix timestamp of alert generation | Current time (Â±5s) |
| severity | string | Alert severity level | "INFO", "WARNING", "ERROR", or "CRITICAL" |
| component | string | Name of the affected component | Required, non-empty |
| metric_name | string | Name of the metric that triggered the alert | Required, non-empty |
| current_value | float64 | Current value that triggered the alert | Any valid float value |
| threshold_value | float64 | Threshold that was exceeded | Any valid float value |
| message | string | Human-readable alert message | Required, non-empty |
| node_name | string | Name of the node that generated the alert | Required, non-empty |
| alert_type | string | Type of alert | "THRESHOLD_EXCEEDED", "RECOVERY", "SYSTEM_EVENT" |
| header | builtin_interfaces/Time | Standard ROS2 header | Auto-generated by ROS2 |

## Example Message
```
alert_id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890"
timestamp: 1702285260.456
severity: "WARNING"
component: "cpu"
metric_name: "cpu_percent"
current_value: 82.5
threshold_value: 80.0
message: "CPU usage exceeded warning threshold"
node_name: "jetson_nano_01"
alert_type: "THRESHOLD_EXCEEDED"
header:
  stamp:
    sec: 1702285260
    nanosec: 456000000
  frame_id: ""
```

## Alert Types

| Type | Description | Example Use Case |
|------|-------------|------------------|
| THRESHOLD_EXCEEDED | A metric has exceeded its configured threshold | CPU usage > 90% |
| RECOVERY | A previously exceeded threshold has returned to normal | CPU usage dropped below warning level |
| SYSTEM_EVENT | A system-level event occurred | Node started/stopped |

## Severity Levels

| Level | Description | Action Required |
|-------|-------------|-----------------|
| INFO | Informational message | No action needed |
| WARNING | Potential issue | Monitor closely |
| ERROR | Problem detected | Investigate |
| CRITICAL | Critical issue | Immediate action required |

## Publishing Rules
- Alerts are published when thresholds are exceeded
- Recovery alerts are published when metrics return to normal ranges
- Each threshold crossing generates a single alert (no duplicate alerts for sustained conditions)
- Alert frequency is limited to prevent flooding

## Expected Subscribers
- Dashboard services
- Operator notification systems
- Automated response systems
- Logging services

## Error Handling
- If an alert cannot be published, it should be logged locally
- The monitoring system should continue operating normally
- Failed alert publishing should not affect health status publishing